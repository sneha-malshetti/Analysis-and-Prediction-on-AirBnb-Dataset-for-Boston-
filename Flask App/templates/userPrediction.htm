
<!DOCTYPE html>
<html lang="en">
	<head>
		<title>User Prediction</title>	
		<meta charset="utf-8">
	  	<meta name="viewport" content="width=device-width, initial-scale=1">
	  	<link rel="icon" href="./images/favicon.ico">

		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

	  	<style>
		  	body {
		  		padding-top:10px;
		  		background-image: url("images/blue-landscape.jpg");
		  	}

		  	.container-fluid {
		  		padding : 10px;
		  		text-align : center;
		  	}
	  		.well h3 {
	  			text-align : center;
	  			
	  		}

	  		.btn-default {
	  			color :#009688;
	  			border : 2px solid #009688;
	  			
	  		}

	  		.button_style {
	  			padding : 25px;
	  			margin : 10px;

	  		}

	  		.btn-default {
	  			width : 600px;
	  			height : 100px;
	  			white-space: normal;
	  		}

	  		.row {
	  			padding : 15px;

	  		}

	  		#back_btn {
	  			float : right;
	  			height : 50px;
	  			width : 150px;
	  		}

			#submit_btn {
	  			
	  			height : 50px;
	  			width : 150px;
	  		}	  		

	  		.col-sm-8 h1 {
	  			float : left;
	  		}

	  		.table {
	  			width : 100%;
	  		}

	  		.table tr td {
	  			width : 200px;
	  		}

	  		.select_section, .textArea {
	  			width : 60%;
	  		}

	  		.table, tr {
	  			 border-style : hidden;
	  		}
	  		
	  		th {
	  			text-align:  center;
	  		}
			.predictedPrice {
				float : left;
			}
			.predictedPrice input {
				margin-left : 50px;
			}
	  	</style>
	</head>

	<body>
		<div class = "container-fluid">
			<div class="col-sm-12">
	      		<div class="well">
	        		<h3>Airbnb Analysis and Prediction</h3>
	            </div>
	        </div>
	        <div class = "row">
		        <div class="col-sm-8">
		        	<h1>Predict the Liking of your property</h1>
		        </div>
		        <div class = "col-sm-4">
		        <a href ="user_home.htm">	<button type="button" class="btn btn-info" id="back_btn"><< Back</button></a>
		        </div>
	        </div>
	        <div>
	        	<table class = "table">
	        		<tr>
	        			<th>
	        				Country:
	        			</th>
	        			<th>
	        				City:
	        			</th>
	        			<th>
	        				From
	        			</th>
	        			<th>
	        				To
	        			</th>
	        		</tr>
	        		<tr>
	        			<td>
	        				<select class = "select_section">
								<option value="US">US</option>
								
							</select>
	        			</td>
	        			<td>
	        				<select class = "select_section">
								<option value="LosAngles">Los Angles</option>
								<option value="Newyork">New York</option>
								
							</select>
	        			</td>
	        			<td>
		        			<input type="range" name="from" id="from" value="50" min="0" max="100">
		        			<input  type = "text" id="fromValue" disabled\>
						</td>
	        			<td>
	        				<input type="range" name="to" id="to" value="50" min="0" max="100">
		        			<input  type = "text" id="toValue" disabled\>
	        			</td>
	        		</tr>
	        	</table>
	        </div>
	        <div>
	        	<table class = "table">
	        		<tr>
	        			<th></th>
	        			<th>Maximum number of people</th>
	        		</tr>
	        		<tr>
	        			<td>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="pets_allowed" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="tv" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="kitchen" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="wifi" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="ac" value="Bike">Pets Allowed<br></label>
	        			</td>
	        			<td rowspan="2" class = "range">
	        				<input type="range" name="noPeople" id="noPeople" value="50" min="0" max="100">
		        			<input  type = "text" id="noPeopleValue" disabled\>
	        			</td>
	        		</tr>
	        		<tr>
	        			<td>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="pets_allowed" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="tv" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="kitchen" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="wifi" value="Bike">Pets Allowed<br></label>
				        	<label class="checkbox-inline">
				        	<input type="checkbox" name="ac" value="Bike">Pets Allowed<br></label>

							</td>

							</tr>
 
"host_response_rate
<input id="host_response_rate" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        host_total_listings_count
		<input id="host_response_rate" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
		
        accommodates
        <input id="accommodates" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
		bathrooms
		<input id="bathrooms" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        beds
		<input id="beds" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        security_deposit
		<input id="security_deposit" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        cleaning_fee
		<input id="cleaning_fee" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        number_of_reviews
		<input id="number_of_reviews" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        review_scores_rating
		<input id="review_scores_rating" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        reviews_per_month
		<input id="reviews_per_month" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        ScoredRating
		<input id="ScoredRating" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        moderatePolicy
		<input id="moderatePolicy" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        flexiblePolicy
		<input id="flexiblePolicy" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        strictPolicy
		<input id="strictPolicy" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        Apartment
		<input id="Apartment" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        Privateroom
		<input id="Privateroom" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        Notinstant_bookable
		<input id="Notinstant_bookable" type="text" class="form-control" placeholder="" value="" maxlength="3"/>
        superhost
		<input id="superhost" type="text" class="form-control" placeholder="" value="" maxlength="3"/>

         
                            </div>
                        </div>					
					
	  	        </table>
				
				
				
				
				
	  	        <input type="submit" class="btn btn-success" id="submit_btn" />
				<br/><br/>
				
				<div class="predictedPrice">
					<b>Predicted Price:</b> <br/>
					<input  type = "text" \>
				</div>
				
				
	    </div>
	</body>

	<script>
			$(document).ready(function(){
				$("#fromValue").val($("#from").val());
				$("#toValue").val($("#from").val());
				$("#noPeopleValue").val($("#noPeople").val());

			    $("#from").mouseup(function(){
			        $("#fromValue").val($("#from").val());
			    });
				
			    $("#to").mouseup(function(){
			        $("#toValue").val($("#to").val());
			    });

			    $("#noPeople").mouseup(function(){
			        $("#noPeopleValue").val($("#noPeople").val());
			    });
			});
		</script>

		
		
		       
                <div id="bodydiv">
                    <div class="row">
                        <div class="col-lg-4">
                            <div id="databaseNames" class="lead text-left">
                              
                        <div class="col-lg-2">
                            <div class="thumb">
                                
                                <a id="pred_lr" href="#" class="thumbnail">
                                  <p>Linear Regression</p>
                                  <img src="static/lr.png" alt="Neural Network">
                                </a>
                            </div>
                            <div class="thumb">
                                <a id="pred_df" href="#" class="thumbnail">
                                    <p>Boosted Decision Tree</p>
                                  <img src="static/dt.png" alt="Decision Tree">
                                </a>

                            </div>
                            <div class="thumb">
                                
                                <a id="pred_nn" href="#" class="thumbnail">
                                    <p>Neural Network</p>
                                  <img src="static/nn.png" alt="Neural Network">
                                </a>
                            </div>
                           
                        </div>
                        <div class="col-lg-6">
                            <div id="rbody">
                                <h4 id ="pretext"></h4>
                                <h4 id="algorithm"></h4>
                                <h3 id="result"></h3>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        <!--Body Wrapper ends-->
        
  
    
    
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="static/antixss.js" type="text/javascript"></script>

    <script>
        
        function validate(){
            
            var accommodates = $('#frm_credit_score').val();
            var bathrooms = $('#bathrooms').val();
            var security_deposit = $('input[name="security_deposit"]:checked').val();
            var cleaning_fee = $('#cleaning_fee').val();
            var reviews_per_month = $('#reviews_per_month').val().concat($('#frm_og_year').val());
            var ScoredRating = $('#ScoredRating option:selected').val();
            var moderatePolicy = $('#moderatePolicy option:selected').val();
            floatregex="^[+]?([0-9]+(?:[\\.][0-9]*)?|\\.[0-9]+)$";
            if(accommodates.match(floatregex)&&(reviews_per_month!="")&&(og_servicer_name!="")&&(security_deposit!="")&&bathrooms.match(floatregex)&&cleaning_fee.match(floatregex)&&(credit_score>=301)&&(credit_score<=850)){
                return true;
            }
            if((accommodates<301)||(accommodates>850)){
               alert("Credit Score must be numeric and between 301 - 850");
                $('#pretext').html("");
                $('#result').html("");
            }
            else{
                alert("All Fields Must be entered and must be positive numeric.");
                 $('#pretext').html("");
                $('#result').html("");
            }
            return false;
        }
        function validateAndReturn(algoType){
            JSON.stringify({name: name })
            var accommodates = $('#accommodates').val();
            var bathrooms = $('#bathrooms').val();
            var security_deposit = $('input[name="security_deposit"]:checked').val();
            var cleaning_fee = $('#cleaning_fee').val();
            var reviews_per_month = $('#reviews_per_month').val();
            var ScoredRating = $('#ScoredRating ').val();
            var strictPolicy = $('#strictPolicy ').val();
            
            floatregex="([0-9]*[.])?[0-9]+";
            if (validate()==true){
                return JSON.stringify({algoType:algoType,accommodates: accommodates,cleaning_fee:cleaning_fee,security_deposit:security_deposit,ScoredRating:ScoredRating, reviews_per_month:reviews_per_month,strictPolicy:strictPolicy});
            }
            else return null;
            
        }
        
        //Event Handler for Clicking Neural Network
        $("#pred_nn").click(function(e){
            //alert($("#frm_credit_score").val());
            var jsonstring=validateAndReturn("pred_nn");
            if(jsonstring!=null){
                $.ajax({
				  method: "POST",
				  url: "/prediction/getPrediction",
				  contentType: "application/json",
				  data: jsonstring
				})
                .done(function(data) {
                    var json_obj = JSON.parse(data);
                    $('#pretext').html("Predicted Interest Rate using");
                    $('#algorithm').html("Neural Network")
                    $('#result').html(json_obj["predicted_interest_rate"]);
                });
            }
            else{
                $('#algorithm').html("Request could not be completed")
            }
            
        });
        
        //Event Handler for Logistic Regression
        $("#pred_lr").click(function(e){
            //alert($("#frm_credit_score").val());
            var jsonstring=validateAndReturn("pred_lr");
            if(jsonstring!=null){
                $.ajax({
				  method: "POST",
				  url: "/prediction/getPrediction",
				  contentType: "application/json",
				  data: jsonstring
				})
                .done(function(data) {
                    var json_obj = JSON.parse(data);
                    $('#pretext').html("Predicted Interest Rate using");
                    $('#algorithm').html("Linear Regression")
                    $('#result').html(json_obj["predicted_interest_rate"]);
                });
            }
            else{
                $('#algorithm').html("Request could not be completed")
            }
            
        });
        
        //Event Handler for Decision Forest
        $("#pred_df").click(function(e){
            //alert($("#frm_credit_score").val());
            var jsonstring=validateAndReturn("pred_df");
            if(jsonstring!=null){
                $.ajax({
				  method: "POST",
				  url: "/prediction/getPrediction",
				  contentType: "application/json",
				  data: jsonstring
				})
                .done(function(data) {
                    var json_obj = JSON.parse(data);
                    $('#pretext').html("Predicted Interest Rate using");
                    $('#algorithm').html("Decision Tree")
                    $('#result').html(json_obj["predicted_interest_rate"]);
                });
            }
            else{
                $('#algorithm').html("Request could not be completed")
            }
            
        });
        
    	//Submit data when enter key is pressed
        $('#user_name').keydown(function(e) {
        	var name = $('#user_name').val();
            if (e.which == 13 && name.length > 0) { //catch Enter key
            	//POST request to API to create a new visitor entry in the database
                $.ajax({
				  method: "POST",
				  url: "./api/visitors",
				  contentType: "application/json",
				  data: JSON.stringify({name: name })
				})
                .done(function(data) {
                    $('#response').html(AntiXSS.sanitizeInput(data));
                    $('#nameInput').hide();
                    getNames();
                });
            }
        });

        //Retreive all the visitors from the database
        function getNames(){
          $.get("./api/visitors")
              .done(function(data) {
                  if(data.length > 0) {
                    data.forEach(function(element, index) {
                      data[index] = AntiXSS.sanitizeInput(element)
                    });
                    $('#databaseNames').html("Database contents: " + JSON.stringify(data));
                  }
              });
          }

          //Call getNames on page load.
          getNames();


    </script>
</html>